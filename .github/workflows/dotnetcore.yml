name: .NET Core

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs:
    build:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                dotnet-version: ["6.x"]

        steps:
            - uses: actions/checkout@v2
            - name: Setup .NET Core
              uses: actions/setup-dotnet@v1
              with:
                  dotnet-version: ${{ matrix.dotnet-version }}
            - name: Install dependencies
              run: dotnet restore src/AmVinDecoder.sln
            - name: Build
              run: dotnet build --configuration Release --no-restore src/AmVinDecoder.sln
            - name: Test
              run: dotnet test --no-restore --verbosity normal src/AmVinDecoder.sln
            - name: Upload dotnet test results
              uses: actions/upload-artifact@v2
              with:
                  name: dotnet-results-${{ matrix.dotnet-version }}
                  path: TestResults-${{ matrix.dotnet-version }}
              # Use always() to always run this step to publish test results when there are test failures
              if: ${{ always() }}
